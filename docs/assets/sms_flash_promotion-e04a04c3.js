import{b as se,W as te,X as re,U as J,Y as A,L,i as j,C as Q,I as X,d as ne,h as ce,l as de,f as ue,Z as me,j as V,$ as pe,m as fe,r as H,a0 as he,w as R,M as ve,n as ge,o as d,c as C,S as U,s as i,t as y,v as oe,z as g,y as s,a1 as W,E,D as _,R as k,x as l,a2 as be,a3 as ae,H as ye,K as _e,a4 as De,a5 as Ce,a6 as le,a7 as Ie,N as Ve,_ as ke,O as z,J as Te,P as we,Q as w,T as Ee,V as Pe}from"./index-20b3045b.js";import{i as Se,a as P,E as Ne,b as G,c as f,d as Be,e as xe,f as Me,g as ze}from"./index-6d1f17fb.js";import{E as Ye}from"./el-date-picker-665d7a05.js";const Ae=se({modelValue:{type:[Boolean,String,Number],default:!1},value:{type:[Boolean,String,Number],default:!1},disabled:{type:Boolean,default:!1},width:{type:[String,Number],default:""},inlinePrompt:{type:Boolean,default:!1},activeIcon:{type:te},inactiveIcon:{type:te},activeText:{type:String,default:""},inactiveText:{type:String,default:""},activeColor:{type:String,default:""},inactiveColor:{type:String,default:""},borderColor:{type:String,default:""},activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},name:{type:String,default:""},validateEvent:{type:Boolean,default:!0},id:String,loading:{type:Boolean,default:!1},beforeChange:{type:re(Function)},size:{type:String,validator:Se},tabindex:{type:[String,Number]}}),Ue={[J]:a=>A(a)||L(a)||j(a),[Q]:a=>A(a)||L(a)||j(a),[X]:a=>A(a)||L(a)||j(a)},Fe=["onClick"],Ke=["id","aria-checked","aria-disabled","name","true-value","false-value","disabled","tabindex","onKeydown"],Oe=["aria-hidden"],qe=["aria-hidden"],Le=["aria-hidden"],Z="ElSwitch",je=ne({name:Z}),He=ne({...je,props:Ae,emits:Ue,setup(a,{expose:t,emit:p}){const n=a,r=De(),{formItem:c}=ce(),b=de(),o=ue("switch");me({from:'"value"',replacement:'"model-value" or "v-model"',scope:Z,version:"2.3.0",ref:"https://element-plus.org/en-US/component/switch.html#attributes",type:"Attribute"},V(()=>{var e;return!!((e=r.vnode.props)!=null&&e.value)}));const{inputId:B}=pe(n,{formItemContext:c}),v=fe(V(()=>n.loading)),h=H(n.modelValue!==!1),I=H(),x=H(),F=V(()=>[o.b(),o.m(b.value),o.is("disabled",v.value),o.is("checked",u.value)]),K=V(()=>({width:he(n.width)}));R(()=>n.modelValue,()=>{h.value=!0}),R(()=>n.value,()=>{h.value=!1});const D=V(()=>h.value?n.modelValue:n.value),u=V(()=>D.value===n.activeValue);[n.activeValue,n.inactiveValue].includes(D.value)||(p(J,n.inactiveValue),p(Q,n.inactiveValue),p(X,n.inactiveValue)),R(u,e=>{var m;I.value.checked=e,n.validateEvent&&((m=c==null?void 0:c.validate)==null||m.call(c,"change").catch(ie=>ve()))});const T=()=>{const e=u.value?n.inactiveValue:n.activeValue;p(J,e),p(Q,e),p(X,e),Ce(()=>{I.value.checked=u.value})},M=()=>{if(v.value)return;const{beforeChange:e}=n;if(!e){T();return}const m=e();[le(m),A(m)].includes(!0)||Ie(Z,"beforeChange must return type `Promise<boolean>` or `boolean`"),le(m)?m.then(ee=>{ee&&T()}).catch(ee=>{}):m&&T()},O=V(()=>o.cssVarBlock({...n.activeColor?{"on-color":n.activeColor}:null,...n.inactiveColor?{"off-color":n.inactiveColor}:null,...n.borderColor?{"border-color":n.borderColor}:null})),q=()=>{var e,m;(m=(e=I.value)==null?void 0:e.focus)==null||m.call(e)};return ge(()=>{I.value.checked=u.value}),t({focus:q,checked:u}),(e,m)=>(d(),C("div",{class:y(i(F)),style:ae(i(O)),onClick:ye(M,["prevent"])},[U("input",{id:i(B),ref_key:"input",ref:I,class:y(i(o).e("input")),type:"checkbox",role:"switch","aria-checked":i(u),"aria-disabled":i(v),name:e.name,"true-value":e.activeValue,"false-value":e.inactiveValue,disabled:i(v),tabindex:e.tabindex,onChange:T,onKeydown:oe(M,["enter"])},null,42,Ke),!e.inlinePrompt&&(e.inactiveIcon||e.inactiveText)?(d(),C("span",{key:0,class:y([i(o).e("label"),i(o).em("label","left"),i(o).is("active",!i(u))])},[e.inactiveIcon?(d(),g(i(E),{key:0},{default:s(()=>[(d(),g(W(e.inactiveIcon)))]),_:1})):_("v-if",!0),!e.inactiveIcon&&e.inactiveText?(d(),C("span",{key:1,"aria-hidden":i(u)},k(e.inactiveText),9,Oe)):_("v-if",!0)],2)):_("v-if",!0),U("span",{ref_key:"core",ref:x,class:y(i(o).e("core")),style:ae(i(K))},[e.inlinePrompt?(d(),C("div",{key:0,class:y(i(o).e("inner"))},[e.activeIcon||e.inactiveIcon?(d(),g(i(E),{key:0,class:y(i(o).is("icon"))},{default:s(()=>[(d(),g(W(i(u)?e.activeIcon:e.inactiveIcon)))]),_:1},8,["class"])):e.activeText||e.inactiveText?(d(),C("span",{key:1,class:y(i(o).is("text")),"aria-hidden":!i(u)},k(i(u)?e.activeText:e.inactiveText),11,qe)):_("v-if",!0)],2)):_("v-if",!0),U("div",{class:y(i(o).e("action"))},[e.loading?(d(),g(i(E),{key:0,class:y(i(o).is("loading"))},{default:s(()=>[l(i(be))]),_:1},8,["class"])):_("v-if",!0)],2)],6),!e.inlinePrompt&&(e.activeIcon||e.activeText)?(d(),C("span",{key:1,class:y([i(o).e("label"),i(o).em("label","right"),i(o).is("active",i(u))])},[e.activeIcon?(d(),g(i(E),{key:0},{default:s(()=>[(d(),g(W(e.activeIcon)))]),_:1})):_("v-if",!0),!e.activeIcon&&e.activeText?(d(),C("span",{key:1,"aria-hidden":!i(u)},k(e.activeText),9,Le)):_("v-if",!0)],2)):_("v-if",!0)],14,Fe))}});var Re=_e(He,[["__file","/home/runner/work/element-plus/element-plus/packages/components/switch/src/switch.vue"]]);const We=Ve(Re);let $;const S=()=>{$=Ne.service({lock:!0,text:"加载中...",spinner:"wave"})},N=()=>{$&&$.close()},Ge=async a=>{S();try{return await P.request({url:"/mall/sms-flash-promotion/one/"+a,method:"get"})}catch(t){throw t}finally{N()}},Je=async a=>{S();try{return await P.request({url:"/mall/sms-flash-promotion/del/"+a,method:"get"})}catch(t){throw t}finally{N()}},Qe=async a=>{S();try{return await P.request({url:"/mall/sms-flash-promotion/edit",method:"post",data:a})}catch(t){throw t}finally{N()}},Xe=async a=>{S();try{return await P.request({url:"/mall/sms-flash-promotion/add",method:"post",data:a})}catch(t){throw t}finally{N()}},Ze=async a=>{S();try{return await P.request({url:"/mall/sms-flash-promotion/page",method:"post",data:a})}catch(t){throw t}finally{N()}},Y={One:Ge,Del:Je,Edit:Qe,Add:Xe,Page:Ze};const $e={data(){return{json:{current:1,size:99},searchText:"",currentPage:1,pageSize:6,total:0,tableData:[],editDialogVisible:!1,editItem:{},selectedRow:null}},computed:{paginatedData(){const a=(this.currentPage-1)*this.pageSize,t=a+this.pageSize;return this.filteredtableData.slice(a,t)},filteredtableData(){return this.searchText?this.tableData.filter(a=>String(a.id).includes(String(this.searchText))):this.tableData}},methods:{openEditDialog(a){this.editItem={...a},this.editDialogVisible=!0},handlePageChange(a){this.currentPage=a},saveEdit(){console.log(this.editItem),G.confirm("确定修改吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const a=this.tableData.findIndex(t=>t.id===this.editItem.id);a!==-1?this.tableData.splice(a,1,this.editItem):this.tableData.push(this.editItem),this.editDialogVisible=!1,f.success("修改成功！"),this.editItem={}}).catch(()=>{f.info("修改取消！")})},fetchData(){Y.Page(this.json).then(a=>{this.tableData=a.data.data.page.records||a.data.records,console.log(this.tableData),f.success("刷新成功！")}).catch(a=>{f.error("刷新失败，请检查网络！"),console.error("Error fetching data:",a)})},Insert(a){Y.Add(a).then(t=>{delete a.isNew,f.success("插入数据成功！")}).catch(t=>{f.error("插入数据失败！"),console.error("保存修改失败:",t)})},Alter(a){Y.Edit(a).then(t=>{console.log("修改保存成功:",t.data),f.success("修改数据成功！")}).catch(t=>{f.error("修改数据失败！"),console.error("保存修改失败:",t)})},Del(a){G.confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{Y.Del(a.id).then(t=>{const p=this.tableData.findIndex(n=>n.id===a.id);p!==-1&&this.tableData.splice(p,1),console.log("删除成功:",t.data),f.success("删除成功！")}).catch(t=>{f.error(response.msg),console.error("删除失败:",t)})}).catch(()=>{})},delND(a){G.confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const t=this.tableData.findIndex(p=>p.id===a.id);t!==-1&&this.tableData.splice(t,1),f.success("删除成功！")}).catch(()=>{f.error("删除失败！"),console.log("取消删除 API",a)})},addAPI(){f.success("添加数据ing");const a={id:0,startDate:"",status:0,title:"",createTime:"",endDate:"",isNew:!0};this.tableData.push(a);const t=Math.ceil(this.tableData.length/this.pageSize);this.handlePageChange(t),this.dialogVisible=!0},formatDateTime(t){if(t==""||!t)return"";var t=new Date(t),p=t.getFullYear(),n=t.getMonth()+1;n=n<10?"0"+n:n;var r=t.getDate();r=r<10?"0"+r:r;var c=t.getHours();c=c<10?"0"+c:c;var b=t.getMinutes();b=b<10?"0"+b:b;var o=t.getSeconds();return o=o<10?"0"+o:o,p+"-"+n+"-"+r+" "+c+":"+b+":"+o}},created(){this.fetchData()}},et={slot:"footer"};function tt(a,t,p,n,r,c){const b=Te,o=ze,B=z("Position"),v=E,h=we,I=z("EditPen"),x=z("Delete"),F=Be,K=xe,D=Ee,u=Ye,T=We,M=Pe,O=Me,q=z("CirclePlusFilled");return d(),C("div",null,[l(b,{modelValue:r.searchText,"onUpdate:modelValue":t[0]||(t[0]=e=>r.searchText=e),placeholder:"请输入搜索关键字",clearable:"",onClear:a.clearSearch,onKeyup:oe(a.performSearch,["enter"]),style:{"margin-bottom":"20px"}},null,8,["modelValue","onClear","onKeyup"]),l(F,{data:c.paginatedData,"header-cell-style":{background:"#eef1f6",color:"#606266"},borde:""},{default:s(()=>[l(o,{prop:"id",label:"id"}),l(o,{prop:"startDate",label:"开始时间"},{default:s(({row:e})=>[w(k(c.formatDateTime(e.startDate)),1)]),_:1}),l(o,{prop:"status",label:"上下线状态"},{default:s(({row:e})=>[w(k(e.status==1?"上线":"下线"),1)]),_:1}),l(o,{prop:"title",label:"名称"}),l(o,{prop:"createTime",label:"创建时间"},{default:s(({row:e})=>[w(k(c.formatDateTime(e.createTime)),1)]),_:1}),l(o,{prop:"endDate",label:"结束时间"},{default:s(({row:e})=>[w(k(c.formatDateTime(e.endDate)),1)]),_:1}),l(o,{label:"操作"},{default:s(({row:e})=>[e.isNew?(d(),g(h,{key:0,class:"custom-button",type:"success",circle:"",onClick:m=>c.Insert(e)},{default:s(()=>[l(v,null,{default:s(()=>[l(B)]),_:1})]),_:2},1032,["onClick"])):(d(),g(h,{key:1,class:"custom-button",type:"warning",circle:"",onClick:m=>c.Alter(e)},{default:s(()=>[l(v,null,{default:s(()=>[l(B)]),_:1})]),_:2},1032,["onClick"])),l(h,{type:"primary",circle:"",onClick:m=>c.openEditDialog(e)},{default:s(()=>[l(v,null,{default:s(()=>[l(I)]),_:1})]),_:2},1032,["onClick"]),e.isNew?(d(),g(h,{key:2,type:"danger",circle:"",onClick:m=>c.delND(e)},{default:s(()=>[l(v,null,{default:s(()=>[l(x)]),_:1})]),_:2},1032,["onClick"])):(d(),g(h,{key:3,type:"danger",circle:"",onClick:m=>c.Del(e)},{default:s(()=>[l(v,null,{default:s(()=>[l(x)]),_:1})]),_:2},1032,["onClick"]))]),_:1})]),_:1},8,["data"]),l(K,{"current-page":r.currentPage,"page-size":r.pageSize,total:c.filteredtableData.length,onCurrentChange:c.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"]),l(O,{class:"form",modelValue:r.editDialogVisible,"onUpdate:modelValue":t[7]||(t[7]=e=>r.editDialogVisible=e),onClose:t[8]||(t[8]=e=>r.editDialogVisible=!1)},{default:s(()=>[l(M,{"label-width":"100px","label-position":"left"},{default:s(()=>[l(D,{label:"名称"},{default:s(()=>[l(b,{modelValue:r.editItem.title,"onUpdate:modelValue":t[1]||(t[1]=e=>r.editItem.title=e)},null,8,["modelValue"])]),_:1}),l(D,{label:"开始时间"},{default:s(()=>[l(u,{modelValue:r.editItem.startDate,"onUpdate:modelValue":t[2]||(t[2]=e=>r.editItem.startDate=e),type:"datetime",placeholder:"选择开始时间",format:"YYYY-MM-DD hh:mm:ss"},null,8,["modelValue"])]),_:1}),l(D,{label:"上下线状态"},{default:s(()=>[l(T,{modelValue:r.editItem.status,"onUpdate:modelValue":t[3]||(t[3]=e=>r.editItem.status=e),"active-color":"#13ce66","inactive-color":"#ff4949","active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1}),l(D,{label:"创建时间"},{default:s(()=>[l(u,{modelValue:r.editItem.createTime,"onUpdate:modelValue":t[4]||(t[4]=e=>r.editItem.createTime=e),type:"datetime",placeholder:"选择开始时间",format:"YYYY-MM-DD hh:mm:ss"},null,8,["modelValue"])]),_:1}),l(D,{label:"结束时间"},{default:s(()=>[l(u,{modelValue:r.editItem.endDate,"onUpdate:modelValue":t[5]||(t[5]=e=>r.editItem.endDate=e),type:"datetime",placeholder:"选择开始时间",format:"YYYY-MM-DD hh:mm:ss"},null,8,["modelValue"])]),_:1})]),_:1}),U("div",et,[l(h,{onClick:t[6]||(t[6]=e=>r.editDialogVisible=!1)},{default:s(()=>[w("取消")]),_:1}),l(h,{type:"primary",onClick:c.saveEdit},{default:s(()=>[w("保存")]),_:1},8,["onClick"])])]),_:1},8,["modelValue"]),l(h,{type:"primary",circle:"",onClick:c.addAPI,style:{"margin-top":"10px"}},{default:s(()=>[l(v,null,{default:s(()=>[l(q)]),_:1})]),_:1},8,["onClick"])])}const ot=ke($e,[["render",tt]]);export{ot as default};
